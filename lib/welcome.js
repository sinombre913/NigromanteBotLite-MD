import{DOMImplementation,XMLSerializer}from'xmldom';import _0x31e2c2 from'jsbarcode';import{JSDOM}from'jsdom';import{readFileSync}from'fs';import{join}from'path';import{spawn}from'child_process';const src=join(__dirname,'..','src'),_svg=readFileSync(join(src,'welcome.svg'),'utf-8'),barcode=_0x1810a3=>{const _0x2f986d=new XMLSerializer(),_0x4856e8=new DOMImplementation()['createDocument']('http://www.w3.org/1999/xhtml','html',null),_0x2be1f3=_0x4856e8['createElementNS']('http://www.w3.org/2000/svg','svg');return _0x31e2c2(_0x2be1f3,_0x1810a3,{'xmlDocument':_0x4856e8}),_0x2f986d['serializeToString'](_0x2be1f3);},imageSetter=(_0x431908,_0x5f099b)=>_0x431908['setAttributeNS']('http://www.w3.org/1999/xlink','xlink:href',_0x5f099b),textSetter=(_0x106cdb,_0x37fada)=>_0x106cdb['textContent']=_0x37fada,{document:svg}=new JSDOM(_svg)['window'],genSVG=async({wid:wid='',pp:pp=join(src,'avatar_contact.png'),title:title='',name:name='',text:text='',background:background=''}={})=>{const _0x1e6004={'code':['#_1661899539392\x20>\x20g:nth-child(6)\x20>\x20image',imageSetter,toBase64(await toImg(barcode(wid['replace'](/[^0-9]/g,'')),'png'),'image/png')],'pp':['#_1661899539392\x20>\x20g:nth-child(3)\x20>\x20image',imageSetter,pp],'text':['#_1661899539392\x20>\x20text.fil1.fnt0',textSetter,text],'title':['#_1661899539392\x20>\x20text.fil2.fnt1',textSetter,title],'name':['#_1661899539392\x20>\x20text.fil2.fnt2',textSetter,name],'bg':['#_1661899539392\x20>\x20g:nth-child(2)\x20>\x20image',imageSetter,background]};for(const [_0x26a754,_0x14a77b,_0x27d96b]of Object['values'](_0x1e6004)){_0x14a77b(svg['querySelector'](_0x26a754),_0x27d96b);}return svg['body']['innerHTML'];},toImg=(_0x5e00ea,_0x57f671='png')=>new Promise((_0x395962,_0x5d19d8)=>{if(!_0x5e00ea)return _0x395962(Buffer['alloc'](0x0));const _0x2353fb=[],_0x207f38=spawn('magick',['convert','svg:-',_0x57f671+':-']);_0x207f38['on']('error',_0x42a73d=>_0x5d19d8(_0x42a73d)),_0x207f38['stdout']['on']('data',_0x469202=>_0x2353fb['push'](_0x469202)),_0x207f38['stdin']['write'](Buffer['from'](_0x5e00ea)),_0x207f38['stdin']['end'](),_0x207f38['on']('close',_0x245912=>{if(_0x245912!==0x0)_0x5d19d8(_0x245912);_0x395962(Buffer['concat'](_0x2353fb));});}),toBase64=(_0x28edbe,_0x97a5be)=>'data:'+_0x97a5be+';base64,'+_0x28edbe['toString']('base64'),render=async({wid:wid='',pp:pp=toBase64(readFileSync(join(src,'avatar_contact.png')),'image/png'),name:name='',title:title='',text:text='',background:background=toBase64(readFileSync(join(src,'Aesthetic','Aesthetic_000.jpeg')),'image/jpeg')}={},_0x5ee690='png')=>{const _0x317767=await genSVG({'wid':wid,'pp':pp,'name':name,'text':text,'background':background,'title':title});return await toImg(_0x317767,_0x5ee690);};if(require['main']===module)render({'wid':'1234567890','name':'John\x20Doe','text':'Lorem\x20ipsum\x0adot\x20sit\x20color','title':'grup\x20testing'},'jpg')['then'](_0x53a981=>{process['stdout']['write'](_0x53a981);});else module['exports']=render;