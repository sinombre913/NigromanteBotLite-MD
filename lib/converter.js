import{promises}from'fs';import{join}from'path';import{spawn}from'child_process';function ffmpeg(_0x5d050f,_0x340ef5=[],_0x2cef04='',_0x3c6e1e=''){return new Promise(async(_0x53f511,_0x3713c0)=>{try{const _0x5e1a42=join(global['__dirname'](import.meta['url']),'../tmp',+new Date()+'.'+_0x2cef04),_0x5e0178=_0x5e1a42+'.'+_0x3c6e1e;await promises['writeFile'](_0x5e1a42,_0x5d050f),spawn('ffmpeg',['-y','-i',_0x5e1a42,..._0x340ef5,_0x5e0178])['on']('error',_0x3713c0)['on']('close',async _0x3b4594=>{try{await promises['unlink'](_0x5e1a42);if(_0x3b4594!==0x0)return _0x3713c0(_0x3b4594);_0x53f511({'data':await promises['readFile'](_0x5e0178),'filename':_0x5e0178,'delete'(){return promises['unlink'](_0x5e0178);}});}catch(_0x487f8f){_0x3713c0(_0x487f8f);}});}catch(_0x109950){_0x3713c0(_0x109950);}});}function toPTT(_0x5a157f,_0x3f252f){return ffmpeg(_0x5a157f,['-vn','-c:a','libopus','-b:a','128k','-vbr','on'],_0x3f252f,'ogg');}function toAudio(_0x224f21,_0x23c646){return ffmpeg(_0x224f21,['-vn','-c:a','libopus','-b:a','128k','-vbr','on','-compression_level','10'],_0x23c646,'opus');}function toVideo(_0x4991ff,_0x39cbcd){return ffmpeg(_0x4991ff,['-c:v','libx264','-c:a','aac','-ab','128k','-ar','44100','-crf','32','-preset','slow'],_0x39cbcd,'mp4');}export{toAudio,toPTT,toVideo,ffmpeg};