import{WAMessageStubType}from'@whiskeysockets/baileys';import _0x5e6d4a from'awesome-phonenumber';import _0x4184c9 from'chalk';import{watchFile}from'fs';const terminalImage=global['opts']['img']?require('terminal-image'):'',urlRegex=(await import('url-regex-safe'))['default']({'strict':![]});export default async function (m,conn={'user':{}}){let _name=await conn['getName'](m['sender']),sender=_0x5e6d4a('+'+m['sender']['replace']('@s.whatsapp.net',''))['getNumber']('international')+(_name?'\x20~'+_name:''),chat=await conn['getName'](m['chat']),img;try{if(global['opts']['img'])img=/sticker|image/gi['test'](m['mtype'])?await terminalImage['buffer'](await m['download']()):![];}catch(e){console['error'](e);}let filesize=(m['msg']?m['msg']['vcard']?m['msg']['vcard']['length']:m['msg']['fileLength']?m['msg']['fileLength']['low']||m['msg']['fileLength']:m['msg']['axolotlSenderKeyDistributionMessage']?m['msg']['axolotlSenderKeyDistributionMessage']['length']:m['text']?m['text']['length']:0x0:m['text']?m['text']['length']:0x0)||0x0,user=global['DATABASE']['data']['users'][m['sender']],me=_0x5e6d4a('+'+(conn['user']?.['jid'])['replace']('@s.whatsapp.net',''))['getNumber']('international');console['log'](('\x0a'+_0x4184c9['redBright']('%s')+'\x20'+_0x4184c9['black'](_0x4184c9['bgYellow']('%s'))+'\x20'+_0x4184c9['black'](_0x4184c9['bgGreen']('%s'))+'\x20'+_0x4184c9['magenta']('%s\x20[%s\x20%sB]')+'\x0a'+_0x4184c9['green']('%s')+'\x20'+_0x4184c9['yellow']('%s%s')+'\x20'+_0x4184c9['blueBright']('to')+'\x20'+_0x4184c9['green']('%s')+'\x20'+_0x4184c9['black'](_0x4184c9['bgYellow']('%s'))+'\x0a')['trim'](),me+'\x20~'+conn['user']['name'],(m['messageTimestamp']?new Date(0x3e8*(m['messageTimestamp']['low']||m['messageTimestamp'])):new Date())['toTimeString'](),m['messageStubType']?WAMessageStubType[m['messageStubType']]:'',filesize,filesize===0x0?0x0:(filesize/0x3f1**Math['floor'](Math['log'](filesize)/Math['log'](0x3e8)))['toFixed'](0x1),['',...'KMGTP'][Math['floor'](Math['log'](filesize)/Math['log'](0x3e8))]||'',sender,m?m['exp']:'?',user?'|'+user['exp']+'|'+user['limit']:''+('|'+user['level']),m['chat']+(chat?'\x20~'+chat:''),m['mtype']?m['mtype']['replace'](/message$/i,'')['replace']('audio',m['msg']['ptt']?'PTT':'audio')['replace'](/^./,v=>v['toUpperCase']()):'');if(img)console['log'](img['trimEnd']());if(typeof m['text']==='string'&&m['text']){let log=m['text']['replace'](/\u200e+/g,''),mdRegex=/(?<=(?:^|[\s\n])\S?)(?:([*_~])(.+?)\1|```((?:.||[\n\r])+?)```)(?=\S?(?:[\s\n]|$))/g,mdFormat=(depth=0x4)=>(_,type,text,monospace)=>{let types={'_':'italic','*':'bold','~':'strikethrough'};text=text||monospace;let formatted=!types[type]||depth<0x1?text:_0x4184c9[types[type]](text['replace'](mdRegex,mdFormat(depth-0x1)));return formatted;};if(log['length']<0x1000)log=log['replace'](urlRegex,(url,i,text)=>{let end=url['length']+i;return i===0x0||end===text['length']||/^\s$/['test'](text[end])&&/^\s$/['test'](text[i-0x1])?_0x4184c9['blueBright'](url):url;});log=log['replace'](mdRegex,mdFormat(0x4));if(m['mentionedJid']){for(let user of m['mentionedJid'])log=log['replace']('@'+user['split']`@`[0x0],_0x4184c9['blueBright']('@'+await conn['getName'](user)));}console['log'](m['error']!=null?_0x4184c9['red'](log):m['isCommand']?_0x4184c9['yellow'](log):log);}if(m['messageStubParameters'])console['log'](m['messageStubParameters']['map'](jid=>{jid=conn['decodeJid'](jid);let name=conn['getName'](jid);return _0x4184c9['gray'](_0x5e6d4a('+'+jid['replace']('@s.whatsapp.net',''))['getNumber']('international')+(name?'\x20~'+name:''));})['join'](',\x20'));if(/document/i['test'](m['mtype']))console['log']('📄\x20'+(m['msg']['fileName']||m['msg']['displayName']||'Document'));else{if(/ContactsArray/i['test'](m['mtype']))console['log']('👨‍👩‍👧‍👦\x20'+('\x20'||''));else{if(/contact/i['test'](m['mtype']))console['log']('👨\x20'+(m['msg']['displayName']||''));else{if(/audio/i['test'](m['mtype'])){const duration=m['msg']['seconds'];console['log']((m['msg']['ptt']?'🎤\x20(PTT\x20':'🎵\x20(')+'AUDIO)\x20'+Math['floor'](duration/0x3c)['toString']()['padStart'](0x2,0x0)+':'+(duration%0x3c)['toString']()['padStart'](0x2,0x0));}}}}console['log']();}let file=global['__filename'](import.meta['url']);watchFile(file,()=>{console['log'](_0x4184c9['redBright']('Update\x20\x27lib/print.js\x27'));});