'use strict';Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['default']=exports['constants']=void 0x0;const _fs2=_interopRequireDefault(require('fs')),_util=require('util'),_path=require('path');function _interopRequireDefault(_0x190ad8){return _0x190ad8&&_0x190ad8['__esModule']?_0x190ad8:{'default':_0x190ad8};}function asyncGeneratorStep(_0x5d6409,_0x130666,_0x4c8ddf,_0xe8d900,_0xd456d7,_0x7b0774,_0x39178d){try{var _0x2475e5=_0x5d6409[_0x7b0774](_0x39178d),_0x55d880=_0x2475e5['value'];}catch(_0x71f95a){_0x4c8ddf(_0x71f95a);return;}_0x2475e5['done']?_0x130666(_0x55d880):Promise['resolve'](_0x55d880)['then'](_0xe8d900,_0xd456d7);}function _asyncToGenerator(_0x5f47be){return function(){const _0x324bdb=this,_0xb1abc5=arguments;return new Promise(function(_0x5eb0f6,_0x185538){const _0x3ae0b1=_0x5f47be['apply'](_0x324bdb,_0xb1abc5);function _0x492c8e(_0x2294df){asyncGeneratorStep(_0x3ae0b1,_0x5eb0f6,_0x185538,_0x492c8e,_0x4aa6dd,'next',_0x2294df);}function _0x4aa6dd(_0x2e5acd){asyncGeneratorStep(_0x3ae0b1,_0x5eb0f6,_0x185538,_0x492c8e,_0x4aa6dd,'throw',_0x2e5acd);}_0x492c8e(undefined);});};}function _defineProperty(_0x93f872,_0x32f297,_0x490cca){return _0x32f297 in _0x93f872?Object['defineProperty'](_0x93f872,_0x32f297,{'value':_0x490cca,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x93f872[_0x32f297]=_0x490cca,_0x93f872;}function _classPrivateMethodGet(_0x357856,_0x4d2643,_0x494097){if(!_0x4d2643['has'](_0x357856))throw new TypeError('attempted\x20to\x20get\x20private\x20field\x20on\x20non-instance');return _0x494097;}const fs={'read':(0x0,_util['promisify'])(_fs2['default']['read']),'write':(0x0,_util['promisify'])(_fs2['default']['write']),'open':(0x0,_util['promisify'])(_fs2['default']['open']),'close':(0x0,_util['promisify'])(_fs2['default']['close'])},nullByte=Buffer['alloc'](0x1);nullByte[0x0]=0x0;const constants={'TYPE_LOSSY':0x0,'TYPE_LOSSLESS':0x1,'TYPE_EXTENDED':0x2};exports['constants']=constants;function VP8Width(_0x180dbe){const _0x2b9f46=_0x180dbe[0x7]<<0x8|_0x180dbe[0x6];return _0x2b9f46&0x3fff;}function VP8Height(_0x193718){const _0x9fed1b=_0x193718[0x9]<<0x8|_0x193718[0x8];return _0x9fed1b&0x3fff;}function VP8LWidth(_0x239b2d){const _0x689d59=_0x239b2d[0x2]<<0x8|_0x239b2d[0x1];return(_0x689d59&0x3fff)+0x1;}function VP8LHeight(_0x56e0bc){let _0x1c248c=_0x56e0bc[0x4]<<0x10|_0x56e0bc[0x3]<<0x8|_0x56e0bc[0x2];return _0x1c248c=_0x1c248c>>0x6,(_0x1c248c&0x3fff)+0x1;}function doesVP8LHaveAlpha(_0x5b14f3){return!!(_0x5b14f3[0x4]&0x10);}function createBasicChunk(_0x702265,_0x36140e){const _0x19d733=Buffer['alloc'](0x8),_0x4356b9=_0x36140e['length'];let _0x4db776;return _0x19d733['write'](_0x702265,0x0),_0x19d733['writeUInt32LE'](_0x4356b9,0x4),_0x4db776=[_0x19d733,_0x36140e],_0x4356b9&0x1&&(_0x4db776[0x2]=nullByte),_0x4db776;}const _convertToExtended=new WeakSet(),_demuxFrame=new WeakSet(),_readHeader=new WeakSet(),_readChunkHeader=new WeakSet(),_readChunkHeader_buf=new WeakSet(),_readChunk_raw=new WeakSet(),_readChunk_VP=new WeakSet(),_readChunk_VP8_buf=new WeakSet(),_readChunk_VP8L=new WeakSet(),_readChunk_VP8L_buf=new WeakSet(),_readChunk_VP8X=new WeakSet(),_readChunk_ANIM=new WeakSet(),_readChunk_ANMF=new WeakSet(),_readChunk_ALPH=new WeakSet(),_readChunk_ALPH_buf=new WeakSet(),_readChunk_ICCP=new WeakSet(),_readChunk_EXIF=new WeakSet(),_readChunk_XMP=new WeakSet(),_readChunk_Skip=new WeakSet(),_read=new WeakSet();class Image{constructor(){_read['add'](this),_readChunk_Skip['add'](this),_readChunk_XMP['add'](this),_readChunk_EXIF['add'](this),_readChunk_ICCP['add'](this),_readChunk_ALPH_buf['add'](this),_readChunk_ALPH['add'](this),_readChunk_ANMF['add'](this),_readChunk_ANIM['add'](this),_readChunk_VP8X['add'](this),_readChunk_VP8L_buf['add'](this),_readChunk_VP8L['add'](this),_readChunk_VP8_buf['add'](this),_readChunk_VP['add'](this),_readChunk_raw['add'](this),_readChunkHeader_buf['add'](this),_readChunkHeader['add'](this),_readHeader['add'](this),_demuxFrame['add'](this),_convertToExtended['add'](this),_defineProperty(this,'data',null),_defineProperty(this,'loaded',![]),_defineProperty(this,'path','');}['clear'](){this['data']=null,this['path']='',this['loaded']=![];}get['width'](){if(!this['loaded'])return undefined;const _0x24cf89=this['data'];return _0x24cf89['extended']?_0x24cf89['extended']['width']:_0x24cf89['vp8l']?_0x24cf89['vp8l']['width']:_0x24cf89['vp8']?_0x24cf89['vp8']['width']:undefined;}get['height'](){if(!this['loaded'])return undefined;const _0x397cb7=this['data'];return _0x397cb7['extended']?_0x397cb7['extended']['height']:_0x397cb7['vp8l']?_0x397cb7['vp8l']['height']:_0x397cb7['vp8']?_0x397cb7['vp8']['height']:undefined;}get['type'](){return this['loaded']?this['data']['type']:undefined;}get['hasAnim'](){return this['loaded']?this['data']['extended']?this['data']['extended']['hasAnim']:![]:![];}get['anim'](){return this['hasAnim']?this['data']['anim']:undefined;}get['frameCount'](){return this['anim']?this['anim']['frameCount']:0x0;}get['iccp'](){return this['data']['extended']?this['data']['extended']['hasICCP']?this['data']['iccp']['raw']:undefined:undefined;}set['iccp'](_0x5eaa2f){!this['data']['extended']&&_classPrivateMethodGet(this,_convertToExtended,_convertToExtended2)['call'](this),_0x5eaa2f===undefined?(this['data']['extended']['hasICCP']=![],delete this['data']['iccp']):(this['data']['iccp']={'raw':_0x5eaa2f},this['data']['extended']['hasICCP']=!![]);}get['exif'](){return this['data']['extended']?this['data']['extended']['hasEXIF']?this['data']['exif']['raw']:undefined:undefined;}set['exif'](_0xda04e){!this['data']['extended']&&_classPrivateMethodGet(this,_convertToExtended,_convertToExtended2)['call'](this),_0xda04e===undefined?(this['data']['extended']['hasEXIF']=![],delete this['data']['exif']):(this['data']['exif']={'raw':_0xda04e},this['data']['extended']['hasEXIF']=!![]);}get['xmp'](){return this['data']['extended']?this['data']['extended']['hasXMP']?this['data']['xmp']['raw']:undefined:undefined;}set['xmp'](_0x39a835){!this['data']['extended']&&_classPrivateMethodGet(this,_convertToExtended,_convertToExtended2)['call'](this),_0x39a835===undefined?(this['data']['extended']['hasXMP']=![],delete this['data']['xmp']):(this['data']['xmp']={'raw':_0x39a835},this['data']['extended']['hasXMP']=!![]);}['load'](_0x441cd0){const _0x3d42f5=this;return _asyncToGenerator(function*(){_0x3d42f5['path']=_0x441cd0,_0x3d42f5['data']=yield _classPrivateMethodGet(_0x3d42f5,_read,_read2)['call'](_0x3d42f5,_0x441cd0),_0x3d42f5['loaded']=!![];})();}['demuxAnim'](_0x231085,_0x30a0d7=-0x1,_0x401fae='#FNAME#'){const _0x512022=this;return _asyncToGenerator(function*(){let _0x18e6f3=0x0,_0x5c9ceb=_0x512022['frameCount'];if(_0x5c9ceb==0x0)throw new Error('This\x20WebP\x20isn\x27t\x20an\x20animation');_0x30a0d7!=-0x1&&(_0x18e6f3=_0x5c9ceb=_0x30a0d7);for(let _0xd8c81b=_0x18e6f3;_0xd8c81b<=_0x5c9ceb;_0xd8c81b++){yield _classPrivateMethodGet(_0x512022,_demuxFrame,_demuxFrame2)['call'](_0x512022,(_0x231085+'/'+_0x401fae+'_'+_0xd8c81b+'.webp')['replace'](/#FNAME#/g,(0x0,_path['basename'])(_0x512022['path'],'.webp')),_0x512022['anim']['frames'][_0xd8c81b]);}})();}['replaceFrame'](_0x5506ad,_0x5514c7){const _0x49b8db=this;return _asyncToGenerator(function*(){if(!_0x49b8db['hasAnim'])throw new Error('WebP\x20isn\x27t\x20animated');if(_0x5514c7<0x0||_0x5514c7>=_0x49b8db['frameCount'])throw new Error('Frame\x20index\x20'+_0x5514c7+'\x20out\x20of\x20bounds\x20(0<=index<'+_0x49b8db['frameCount']+')');const _0x327d8f=new Image();yield _0x327d8f['load'](_0x5506ad);switch(_0x327d8f['type']){case constants['TYPE_LOSSY']:case constants['TYPE_LOSSLESS']:break;case constants['TYPE_EXTENDED']:if(_0x327d8f['hasAnim'])throw new Error('Merging\x20animations\x20not\x20currently\x20supported');break;default:throw new Error('Unknown\x20WebP\x20type');}switch(_0x49b8db['anim']['frames'][_0x5514c7]['type']){case constants['TYPE_LOSSY']:_0x49b8db['anim']['frames'][_0x5514c7]['vp8']['alpha']&&delete _0x49b8db['anim']['frames'][_0x5514c7]['alph'];delete _0x49b8db['anim']['frames'][_0x5514c7]['vp8'];break;case constants['TYPE_LOSSLESS']:delete _0x49b8db['anim']['frames'][_0x5514c7]['vp8l'];break;default:throw new Error('Unknown\x20frame\x20type');}switch(_0x327d8f['type']){case constants['TYPE_LOSSY']:_0x49b8db['anim']['frames'][_0x5514c7]['vp8']=_0x327d8f['data']['vp8'];break;case constants['TYPE_LOSSLESS']:_0x49b8db['anim']['frames'][_0x5514c7]['vp8l']=_0x327d8f['data']['vp8l'];break;case constants['TYPE_EXTENDED']:if(_0x327d8f['data']['vp8'])_0x49b8db['anim']['frames'][_0x5514c7]['vp8']=_0x327d8f['data']['vp8'],_0x327d8f['data']['vp8']['alpha']&&(_0x49b8db['anim']['frames'][_0x5514c7]['alph']=_0x327d8f['data']['alph']);else _0x327d8f['data']['vp8l']&&(_0x49b8db['anim']['frames'][_0x5514c7]['vp8l']=_0x327d8f['data']['vp8l']);break;}_0x49b8db['anim']['frames'][_0x5514c7]['width']=_0x327d8f['width'],_0x49b8db['anim']['frames'][_0x5514c7]['height']=_0x327d8f['height'];})();}['muxAnim']({path:_0x18ca43,bgColor:bgColor=[0xff,0xff,0xff,0xff],loops:loops=0x0}={}){const _0x4cb769=this;return _asyncToGenerator(function*(){return Image['muxAnim']({'path':_0x18ca43,'bgColor':bgColor,'loops':loops,'frames':_0x4cb769['frames']});})();}static['muxAnim']({path:_0x437d7a,frames:_0x2ed700,width:width=0x0,height:height=0x0,bgColor:bgColor=[0xff,0xff,0xff,0xff],loops:loops=0x0,delay:delay=0x64,x:x=0x0,y:y=0x0,blend:blend=!![],dispose:dispose=![]}={}){return _asyncToGenerator(function*(){const _0x4d1c81=Buffer['alloc'](0xc);let _0x59e5a2=Buffer['alloc'](0x12);const _0x1af5d4=[];let _0xe7e987,_0x51cbcf=![],_0x429a75,_0x52b9a7=0x0,_0x2de5cd=0x0;const _0x53b88e=width-0x1,_0x12afd1=height-0x1;if(_0x2ed700['length']==0x0)throw new Error('No\x20frames\x20to\x20mux');else{if(_0x53b88e<=0x0||_0x53b88e>0x1<<0x18)throw new Error('Width\x20out\x20of\x20range');else{if(_0x12afd1<=0x0||_0x12afd1>0x1<<0x18)throw new Error('Height\x20out\x20of\x20range');else{if(_0x12afd1*_0x53b88e>Math['pow'](0x2,0x20)-0x1)throw new Error('Width*height\x20too\x20large\x20('+_0x53b88e+',\x20'+_0x12afd1+')');else{if(loops<0x0||loops>=0x1<<0x18)throw new Error('Loops\x20out\x20of\x20range');else{if(delay<0x0||delay>=0x1<<0x18)throw new Error('Delay\x20out\x20of\x20range');else{if(x<0x0||x>=0x1<<0x18)throw new Error('X\x20out\x20of\x20range');else{if(y<0x0||y>=0x1<<0x18)throw new Error('Y\x20out\x20of\x20range');}}}}}}}_0x4d1c81['write']('RIFF',0x0),_0x4d1c81['write']('WEBP',0x8),_0x59e5a2['write']('VP8X',0x0),_0x59e5a2['writeUInt32LE'](0xa,0x4),_0x59e5a2[0x8]|=0x2;width!=0x0&&_0x59e5a2['writeUIntLE'](_0x53b88e,0xc,0x3);height!=0x0&&_0x59e5a2['writeUIntLE'](_0x12afd1,0xf,0x3);_0x1af5d4['push'](_0x4d1c81,_0x59e5a2),_0x59e5a2=Buffer['alloc'](0xe),_0x59e5a2['write']('ANIM',0x0),_0x59e5a2['writeUInt32LE'](0x6,0x4),_0x59e5a2['writeUInt8'](bgColor[0x2],0x8),_0x59e5a2['writeUInt8'](bgColor[0x1],0x9),_0x59e5a2['writeUInt8'](bgColor[0x0],0xa),_0x59e5a2['writeUInt8'](bgColor[0x3],0xb),_0x59e5a2['writeUInt16LE'](loops,0xc),_0x1af5d4['push'](_0x59e5a2);for(let _0x361c90=0x0,_0x2bb638=_0x2ed700['length'];_0x361c90<_0x2bb638;_0x361c90++){const _0x36a37c=typeof _0x2ed700[_0x361c90]['delay']==='undefined'?delay:_0x2ed700[_0x361c90]['delay'],_0x5274ec=typeof _0x2ed700[_0x361c90]['x']==='undefined'?x:_0x2ed700[_0x361c90]['x'],_0x2764e5=typeof _0x2ed700[_0x361c90]['y']==='undefined'?y:_0x2ed700[_0x361c90]['y'],_0x52e502=typeof _0x2ed700[_0x361c90]['blend']==='undefined'?blend:_0x2ed700[_0x361c90]['blend'],_0x1dafcc=typeof _0x2ed700[_0x361c90]['dispose']==='undefined'?dispose:_0x2ed700[_0x361c90]['dispose'];let _0x465185=0x10,_0x4f83ab=!![],_0x40291f;if(delay<0x0||delay>=0x1<<0x18)throw new Error('Delay\x20out\x20of\x20range\x20on\x20frame\x20'+_0x361c90);else{if(x<0x0||x>=0x1<<0x18)throw new Error('X\x20out\x20of\x20range\x20on\x20frame\x20'+_0x361c90);else{if(y<0x0||y>=0x1<<0x18)throw new Error('Y\x20out\x20of\x20range\x20on\x20frame\x20'+_0x361c90);}}_0x59e5a2=Buffer['alloc'](0x18),_0x59e5a2['write']('ANMF',0x0),_0x59e5a2['writeUIntLE'](_0x5274ec,0x8,0x3),_0x59e5a2['writeUIntLE'](_0x2764e5,0xb,0x3),_0x59e5a2['writeUIntLE'](_0x36a37c,0x14,0x3);!_0x52e502&&(_0x59e5a2[0x17]|=0x2);_0x1dafcc&&(_0x59e5a2[0x17]|=0x1);_0x2ed700[_0x361c90]['path']?(_0xe7e987=new Image(),yield _0xe7e987['load'](_0x2ed700[_0x361c90]['path'])):_0xe7e987={'data':_0x2ed700[_0x361c90]};_0x59e5a2['writeUIntLE'](_0xe7e987['data']['width']-0x1,0xe,0x3),_0x59e5a2['writeUIntLE'](_0xe7e987['data']['height']-0x1,0x11,0x3);switch(_0xe7e987['data']['type']){case constants['TYPE_LOSSY']:{const _0x9926b4=_0xe7e987['data']['vp8'];_0x52b9a7=_0x9926b4['width']>_0x52b9a7?_0x9926b4['width']:_0x52b9a7,_0x2de5cd=_0x9926b4['height']>_0x2de5cd?_0x9926b4['height']:_0x2de5cd,_0x465185+=_0x9926b4['raw']['length']+0x8,_0x40291f=createBasicChunk('VP8\x20',_0x9926b4['raw']);}break;case constants['TYPE_LOSSLESS']:{const _0x5df7c7=_0xe7e987['data']['vp8l'];_0x52b9a7=_0x5df7c7['width']>_0x52b9a7?_0x5df7c7['width']:_0x52b9a7,_0x2de5cd=_0x5df7c7['height']>_0x2de5cd?_0x5df7c7['height']:_0x2de5cd,_0x465185+=_0x5df7c7['raw']['length']+0x8,_0x5df7c7['alpha']&&(_0x51cbcf=!![]),_0x40291f=createBasicChunk('VP8L',_0x5df7c7['raw']);}break;case constants['TYPE_EXTENDED']:if(_0xe7e987['data']['extended']['hasAnim']){const _0x3d7ff6=_0xe7e987['data']['anim']['frames'];_0x4f83ab=![];_0xe7e987['data']['extended']['hasAlpha']&&(_0x51cbcf=!![]);for(let _0x2f6b83=0x0,_0x390a40=_0x3d7ff6['length'];_0x2f6b83<_0x390a40;_0x2f6b83++){_0x52b9a7=_0x3d7ff6[_0x2f6b83]['width']+_0x5274ec>_0x52b9a7?_0x3d7ff6[_0x2f6b83]['width']+_0x5274ec:_0x52b9a7,_0x2de5cd=_0x3d7ff6[_0x2f6b83]['height']+_0x2764e5>_0x2de5cd?_0x3d7ff6[_0x2f6b83]['height']+_0x2764e5:_0x2de5cd;let _0x1905df=Buffer['alloc'](0x8);_0x1905df['write']('ANMF',0x0),_0x1905df['writeUInt32LE'](_0x3d7ff6[_0x2f6b83]['raw']['length'],0x4),_0x1af5d4['push'](_0x1905df,_0x3d7ff6[_0x2f6b83]['raw']),_0x3d7ff6[_0x2f6b83]['raw']['length']&0x1&&_0x1af5d4['push'](nullByte),_0x1905df=_0x3d7ff6[_0x2f6b83]['raw'],_0x1905df['writeUIntLE'](_0x5274ec,0x0,0x3),_0x1905df['writeUIntLE'](_0x2764e5,0x3,0x3),_0x1905df['writeUIntLE'](_0x36a37c,0xc,0x3),!_0x52e502?_0x1905df[0xf]|=0x2:_0x1905df[0xf]&=0xfd,_0x1dafcc?_0x1905df[0xf]|=0x1:_0x1905df[0xf]&=0xfe;}}else{_0x52b9a7=_0xe7e987['data']['extended']['width']>_0x52b9a7?_0xe7e987['data']['extended']['width']:_0x52b9a7,_0x2de5cd=_0xe7e987['data']['extended']['height']>_0x2de5cd?_0xe7e987['data']['extended']['height']:_0x2de5cd;if(_0xe7e987['data']['vp8'])_0x40291f=[],_0xe7e987['data']['alph']&&(_0x51cbcf=!![],_0x40291f['push'](...createBasicChunk('ALPH',_0xe7e987['data']['alph']['raw'])),_0x465185+=_0xe7e987['data']['alph']['raw']['length']+0x8),_0x40291f['push'](...createBasicChunk('VP8\x20',_0xe7e987['data']['vp8']['raw'])),_0x465185+=_0xe7e987['data']['vp8']['raw']['length']+0x8;else _0xe7e987['data']['vp8l']&&(_0x40291f=createBasicChunk('VP8L',_0xe7e987['data']['vp8l']['raw']),_0xe7e987['data']['vp8l']['alpha']&&(_0x51cbcf=!![]),_0x465185+=_0xe7e987['data']['vp8l']['raw']['length']+0x8);}break;default:throw new Error('Unknown\x20image\x20type');}_0x4f83ab&&(_0x59e5a2['writeUInt32LE'](_0x465185,0x4),_0x1af5d4['push'](_0x59e5a2,..._0x40291f));}width==0x0&&_0x1af5d4[0x1]['writeUIntLE'](_0x52b9a7-0x1,0xc,0x3);height==0x0&&_0x1af5d4[0x1]['writeUIntLE'](_0x2de5cd-0x1,0xf,0x3);_0x429a75=0x4;for(let _0x4ff72e=0x1,_0x919223=_0x1af5d4['length'];_0x4ff72e<_0x919223;_0x4ff72e++){_0x429a75+=_0x1af5d4[_0x4ff72e]['length'];}_0x4d1c81['writeUInt32LE'](_0x429a75,0x4);_0x51cbcf&&(_0x1af5d4[0x1][0x8]|=0x10);const _0x29c558=yield fs['open'](_0x437d7a,'w');for(let _0x3d4cf6=0x0,_0x1cab33=_0x1af5d4['length'];_0x3d4cf6<_0x1cab33;_0x3d4cf6++){yield fs['write'](_0x29c558,_0x1af5d4[_0x3d4cf6],0x0,undefined,undefined);}yield fs['close'](_0x29c558);})();}}var _convertToExtended2=function _convertToExtended2(){if(!this['loaded'])throw new Error('No\x20image\x20loaded');this['data']['type']=constants['TYPE_EXTENDED'],this['data']['extended']={'hasICC':![],'hasAlpha':![],'hasEXIF':![],'hasXMP':![],'width':this['vp8']?this['vp8']['width']:this['vp8l']?this['vp8l']['width']:0x1,'height':this['vp8']?this['vp8']['height']:this['vp8l']?this['vp8l']['height']:0x1};},_demuxFrame2=(function(){const _0x5e1267=_asyncToGenerator(function*(_0x453ac5,_0x1749f9){const _0x3d66b8=Buffer['alloc'](0xc);let _0x46b1f0,_0x2eb15e;const _0x33b8b2=[];_0x3d66b8['write']('RIFF',0x0),_0x3d66b8['write']('WEBP',0x8),_0x33b8b2['push'](_0x3d66b8);(this['data']['extended']['hasICC']||this['data']['extended']['hasEXIF']||this['data']['extended']['hasXMP']||_0x1749f9['vp8']&&_0x1749f9['vp8']['alpha'])&&(_0x2eb15e=Buffer['alloc'](0x12),_0x2eb15e['write']('VP8X',0x0),_0x2eb15e['writeUInt32LE'](0xa,0x4),this['data']['extended']['hasICC']&&(_0x2eb15e[0x8]|=0x20),(_0x1749f9['vp8l']&&_0x1749f9['vp8l']['alpha']||_0x1749f9['vp8']&&_0x1749f9['vp8']['alpha'])&&(_0x2eb15e[0x8]|=0x10),this['data']['extended']['hasEXIF']&&(_0x2eb15e[0x8]|=0x8),this['data']['extended']['hasXMP']&&(_0x2eb15e[0x8]|=0x4),_0x2eb15e['writeUIntLE'](_0x1749f9['width']-0x1,0xc,0x3),_0x2eb15e['writeUIntLE'](_0x1749f9['height']-0x1,0xf,0x3),_0x33b8b2['push'](_0x2eb15e),this['data']['extended']['hasICC']&&_0x33b8b2['push'](...createBasicChunk('ICCP',this['data']['extended']['icc']['raw'])));if(_0x1749f9['vp8l'])_0x33b8b2['push'](...createBasicChunk('VP8L',_0x1749f9['vp8l']['raw']));else{if(_0x1749f9['vp8'])_0x1749f9['vp8']['alpha']&&_0x33b8b2['push'](...createBasicChunk('ALPH',_0x1749f9['alph']['raw'])),_0x33b8b2['push'](...createBasicChunk('VP8\x20',_0x1749f9['vp8']['raw']));else throw new Error('Frame\x20has\x20no\x20VP8/VP8L?');}this['type']==constants['TYPE_EXTENDED']&&(this['data']['extended']['hasEXIF']&&_0x33b8b2['push'](...createBasicChunk('EXIF',this['data']['extended']['exif']['raw'])),this['data']['extended']['hasXMP']&&_0x33b8b2['push'](...createBasicChunk('XMP\x20',this['data']['extended']['xmp']['raw'])));_0x46b1f0=0x4;for(let _0x420f01=0x1,_0x267c74=_0x33b8b2['length'];_0x420f01<_0x267c74;_0x420f01++){_0x46b1f0+=_0x33b8b2[_0x420f01]['length'];}_0x3d66b8['writeUInt32LE'](_0x46b1f0,0x4);const _0x4931ce=yield fs['open'](_0x453ac5,'w');for(let _0x1ae0a1=0x0,_0x2f51ca=_0x33b8b2['length'];_0x1ae0a1<_0x2f51ca;_0x1ae0a1++){yield fs['write'](_0x4931ce,_0x33b8b2[_0x1ae0a1],0x0,undefined,undefined);}yield fs['close'](_0x4931ce);});function _0x388ec7(_0x391dd0,_0x2c378b){return _0x5e1267['apply'](this,arguments);}return _0x388ec7;}());const _readHeader2=(function(){const _0x23c62c=_asyncToGenerator(function*(_0x2ffe8c){const _0x583706=Buffer['alloc'](0xc),{bytesRead:_0x5efb7a}=yield fs['read'](_0x2ffe8c,_0x583706,0x0,0xc,undefined);if(_0x5efb7a!=0xc)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20header');if(_0x583706['toString']('utf8',0x0,0x4)!='RIFF')throw new Error('Bad\x20header\x20(not\x20RIFF)');if(_0x583706['toString']('utf8',0x8,0xc)!='WEBP')throw new Error('Bad\x20header\x20(not\x20WEBP)');return{'fileSize':_0x583706['readUInt32LE'](0x4)};});function _0x3ce05e(_0x2de6c3){return _0x23c62c['apply'](this,arguments);}return _0x3ce05e;}()),_readChunkHeader2=(function(){const _0x36a24e=_asyncToGenerator(function*(_0x11d964){const _0x566153=Buffer['alloc'](0x8),{bytesRead:_0x43149d}=yield fs['read'](_0x11d964,_0x566153,0x0,0x8,undefined);if(_0x43149d==0x0)return{'fourCC':'\x00\x00\x00\x00','size':0x0};else{if(_0x43149d<0x8)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20chunk\x20header');}return{'fourCC':_0x566153['toString']('utf8',0x0,0x4),'size':_0x566153['readUInt32LE'](0x4)};});function _0xfc44c7(_0x1c7341){return _0x36a24e['apply'](this,arguments);}return _0xfc44c7;}()),_readChunkHeader_buf2=function _readChunkHeader_buf2(_0x4d1f0d,_0x236433){if(_0x236433>=_0x4d1f0d['length'])return{'fourCC':'\x00\x00\x00\x00','size':0x0};return{'fourCC':_0x4d1f0d['toString']('utf8',_0x236433,_0x236433+0x4),'size':_0x4d1f0d['readUInt32LE'](_0x236433+0x4)};},_readChunk_raw2=(function(){const _0x1c7f50=_asyncToGenerator(function*(_0x13eba1,_0x47213d,_0x48f600){const _0x59ead6=Buffer['alloc'](_0x48f600),_0x654cc4=Buffer['alloc'](0x1),{bytesRead:_0x207790}=yield fs['read'](_0x47213d,_0x59ead6,0x0,_0x48f600,undefined);if(_0x207790!=_0x48f600)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20'+_0x13eba1+'\x20chunk');return _0x48f600&0x1&&(yield fs['read'](_0x47213d,_0x654cc4,0x0,0x1,undefined)),{'raw':_0x59ead6};});function _0x2bf336(_0x13fc9a,_0x29a283,_0x5ee380){return _0x1c7f50['apply'](this,arguments);}return _0x2bf336;}()),_readChunk_VP2=(function(){const _0x1130e6=_asyncToGenerator(function*(_0x27472f,_0x48c0c3){const _0x4a8d17=Buffer['alloc'](_0x48c0c3),_0x1ecf94=Buffer['alloc'](0x1),{bytesRead:_0x42eded}=yield fs['read'](_0x27472f,_0x4a8d17,0x0,_0x48c0c3,undefined);if(_0x42eded!=_0x48c0c3)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20VP8\x20chunk');return _0x48c0c3&0x1&&(yield fs['read'](_0x27472f,_0x1ecf94,0x0,0x1,undefined)),{'raw':_0x4a8d17,'width':VP8Width(_0x4a8d17,0x8),'height':VP8Height(_0x4a8d17,0x8)};});function _0x385e8c(_0x31f576,_0x430b72){return _0x1130e6['apply'](this,arguments);}return _0x385e8c;}()),_readChunk_VP8_buf2=function _readChunk_VP8_buf2(_0x5f0574,_0xf92e18,_0x339f41){if(_0x339f41>=_0x5f0574['length'])throw new Error('Reached\x20end\x20of\x20buffer\x20while\x20reading\x20VP8\x20chunk');const _0x5039bf=_0x5f0574['slice'](_0x339f41,_0x339f41+_0xf92e18);return{'raw':_0x5039bf,'width':VP8Width(_0x5039bf),'height':VP8Height(_0x5039bf)};},_readChunk_VP8L2=(function(){const _0x6ba73b=_asyncToGenerator(function*(_0x2e3052,_0x4ce32a){const _0x2a48ff=Buffer['alloc'](_0x4ce32a),_0x592893=Buffer['alloc'](0x1),{bytesRead:_0x1eafd9}=yield fs['read'](_0x2e3052,_0x2a48ff,0x0,_0x4ce32a,undefined);if(_0x1eafd9!=_0x4ce32a)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20VP8L\x20chunk');return _0x4ce32a&0x1&&(yield fs['read'](_0x2e3052,_0x592893,0x0,0x1,undefined)),{'raw':_0x2a48ff,'alpha':doesVP8LHaveAlpha(_0x2a48ff,0x0),'width':VP8LWidth(_0x2a48ff),'height':VP8LHeight(_0x2a48ff)};});function _0x4dd181(_0x5902c2,_0x3452eb){return _0x6ba73b['apply'](this,arguments);}return _0x4dd181;}()),_readChunk_VP8L_buf2=function _readChunk_VP8L_buf2(_0x1b34e0,_0x3e6635,_0x111e6b){if(_0x111e6b>=_0x1b34e0['length'])throw new Error('Reached\x20end\x20of\x20buffer\x20while\x20reading\x20VP8L\x20chunk');const _0x1b1c29=_0x1b34e0['slice'](_0x111e6b,_0x111e6b+_0x3e6635);return{'raw':_0x1b1c29,'alpha':doesVP8LHaveAlpha(_0x1b1c29),'width':VP8LWidth(_0x1b1c29),'height':VP8LHeight(_0x1b1c29)};},_readChunk_VP8X2=(function(){const _0x3f258b=_asyncToGenerator(function*(_0x4bb9b8,_0x15ad88){const _0x53600a=Buffer['alloc'](_0x15ad88),{bytesRead:_0x34f30a}=yield fs['read'](_0x4bb9b8,_0x53600a,0x0,_0x15ad88,undefined);if(_0x34f30a!=_0x15ad88)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20VP8X\x20chunk');return{'raw':_0x53600a,'hasICC':!!(_0x53600a[0x0]&0x20),'hasAlpha':!!(_0x53600a[0x0]&0x10),'hasEXIF':!!(_0x53600a[0x0]&0x8),'hasXMP':!!(_0x53600a[0x0]&0x4),'hasAnim':!!(_0x53600a[0x0]&0x2),'width':_0x53600a['readUIntLE'](0x4,0x3)+0x1,'height':_0x53600a['readUIntLE'](0x7,0x3)+0x1};});function _0x2c5b25(_0x112e86,_0x3522c8){return _0x3f258b['apply'](this,arguments);}return _0x2c5b25;}()),_readChunk_ANIM2=(function(){const _0x11e7ca=_asyncToGenerator(function*(_0x3e17dc,_0xcfeae8){const _0x4e0fa8=Buffer['alloc'](_0xcfeae8),{bytesRead:_0x4f512b}=yield fs['read'](_0x3e17dc,_0x4e0fa8,0x0,_0xcfeae8,undefined);if(_0x4f512b!=_0xcfeae8)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20ANIM\x20chunk');return{'raw':_0x4e0fa8,'bgColor':_0x4e0fa8['slice'](0x0,0x4),'loopCount':_0x4e0fa8['readUInt16LE'](0x4)};});function _0x5488a7(_0x10bd5b,_0x3af8e1){return _0x11e7ca['apply'](this,arguments);}return _0x5488a7;}()),_readChunk_ANMF2=(function(){const _0x378bd1=_asyncToGenerator(function*(_0x17b1f9,_0x5667b1){const _0x43bd50=Buffer['alloc'](_0x5667b1),_0xb28cff=Buffer['alloc'](0x1),{bytesRead:_0x747611}=yield fs['read'](_0x17b1f9,_0x43bd50,0x0,_0x5667b1,undefined);if(_0x747611!=_0x5667b1)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20ANMF\x20chunk');_0x5667b1&0x1&&(yield fs['read'](_0x17b1f9,_0xb28cff,0x0,0x1,undefined));const _0x520e5a={'raw':_0x43bd50,'x':_0x43bd50['readUIntLE'](0x0,0x3),'y':_0x43bd50['readUIntLE'](0x3,0x3),'width':_0x43bd50['readUIntLE'](0x6,0x3)+0x1,'height':_0x43bd50['readUIntLE'](0x9,0x3)+0x1,'duration':_0x43bd50['readUIntLE'](0xc,0x3),'blend':!(_0x43bd50[0xf]&0x2),'dispose':!!(_0x43bd50[0xf]&0x1)};let _0x48563e=!![],_0x4941f2=0x10;while(_0x48563e){const _0x30c285=_classPrivateMethodGet(this,_readChunkHeader_buf,_readChunkHeader_buf2)['call'](this,_0x43bd50,_0x4941f2);let _0x5a9fb3;_0x4941f2+=0x8;switch(_0x30c285['fourCC']){case'VP8\x20':!_0x520e5a['vp8']&&(_0x520e5a['type']=constants['TYPE_LOSSY'],_0x520e5a['vp8']=_classPrivateMethodGet(this,_readChunk_VP8_buf,_readChunk_VP8_buf2)['call'](this,_0x43bd50,_0x30c285['size'],_0x4941f2));break;case'VP8L':!_0x520e5a['vp8l']&&(_0x520e5a['type']=constants['TYPE_LOSSLESS'],_0x520e5a['vp8l']=_classPrivateMethodGet(this,_readChunk_VP8L_buf,_readChunk_VP8L_buf2)['call'](this,_0x43bd50,_0x30c285['size'],_0x4941f2));break;case'ALPH':_0x520e5a['vp8']&&(_0x520e5a['alph']=_classPrivateMethodGet(this,_readChunk_ALPH_buf,_readChunk_ALPH_buf2)['call'](this,_0x43bd50,_0x30c285['size'],_0x4941f2),_0x520e5a['vp8']['alpha']=!![]);break;case'\x00\x00\x00\x00':default:_0x48563e=![];break;}_0x4941f2+=_0x30c285['size']+0x1,_0x30c285['size']&0x1&&_0x4941f2++,_0x4941f2>=_0x43bd50['length']&&(_0x48563e=![]);}return _0x520e5a;});function _0x45e961(_0x450962,_0x2ec3d5){return _0x378bd1['apply'](this,arguments);}return _0x45e961;}()),_readChunk_ALPH2=(function(){const _0x166e5a=_asyncToGenerator(function*(_0x27d3a6,_0xa29f32){return _classPrivateMethodGet(this,_readChunk_raw,_readChunk_raw2)['call'](this,'ALPH',_0x27d3a6,_0xa29f32);});function _0x2a6c80(_0x13c8fb,_0x1ae649){return _0x166e5a['apply'](this,arguments);}return _0x2a6c80;}());var _readChunk_ALPH_buf2=function _readChunk_ALPH_buf2(_0x225fc2,_0x371784,_0x4929c1){if(cusor>=_0x225fc2['length'])throw new Error('Reached\x20end\x20of\x20buffer\x20while\x20reading\x20ALPH\x20chunk');return{'raw':_0x225fc2['slice'](_0x4929c1,_0x4929c1+_0x371784)};};const _readChunk_ICCP2=(function(){const _0x30ed5a=_asyncToGenerator(function*(_0x3b607c,_0x437df5){return _classPrivateMethodGet(this,_readChunk_raw,_readChunk_raw2)['call'](this,'ICCP',_0x3b607c,_0x437df5);});function _0x49baaa(_0x57b5c4,_0x5b3e70){return _0x30ed5a['apply'](this,arguments);}return _0x49baaa;}()),_readChunk_EXIF2=(function(){const _0x4ce776=_asyncToGenerator(function*(_0x378054,_0x52df0c){return _classPrivateMethodGet(this,_readChunk_raw,_readChunk_raw2)['call'](this,'EXIF',_0x378054,_0x52df0c);});function _0x5820e9(_0x3e110c,_0x2f10f3){return _0x4ce776['apply'](this,arguments);}return _0x5820e9;}()),_readChunk_XMP2=(function(){const _0x133a74=_asyncToGenerator(function*(_0x51e385,_0x12b2b7){return _classPrivateMethodGet(this,_readChunk_raw,_readChunk_raw2)['call'](this,'XML',_0x51e385,_0x12b2b7);});function _0x55c2eb(_0x38d91c,_0x5081d9){return _0x133a74['apply'](this,arguments);}return _0x55c2eb;}()),_readChunk_Skip2=(function(){const _0x72b731=_asyncToGenerator(function*(_0x1730cd,_0x58528f){const _0x3f45ff=Buffer['alloc'](_0x58528f),_0x2af6a1=Buffer['alloc'](0x1),{bytesRead:_0x26f885}=yield fs['read'](_0x1730cd,_0x3f45ff,0x0,_0x58528f,undefined);if(_0x26f885!=_0x58528f)throw new Error('Reached\x20end\x20of\x20file\x20while\x20skipping\x20chunk');_0x58528f&0x1&&(yield fs['read'](_0x1730cd,_0x2af6a1,0x0,0x1,undefined));});function _0x3765ec(_0x3d4cef,_0x4e85c2){return _0x72b731['apply'](this,arguments);}return _0x3765ec;}());var _read2=(function(){const _0x22140e=_asyncToGenerator(function*(_0x2b166a){const _0x244b0a=yield fs['open'](_0x2b166a,'r'),_0x348616={};let _0x4cb178=!![],_0x585000=!![];const {fileSize:_0x1321a2}=yield _classPrivateMethodGet(this,_readHeader,_readHeader2)['call'](this,_0x244b0a);while(_0x4cb178){const {fourCC:_0x776bc4,size:_0x62d2d0}=yield _classPrivateMethodGet(this,_readChunkHeader,_readChunkHeader2)['call'](this,_0x244b0a);switch(_0x776bc4){case'VP8\x20':!_0x348616['vp8']?_0x348616['vp8']=yield _classPrivateMethodGet(this,_readChunk_VP,_readChunk_VP2)['call'](this,_0x244b0a,_0x62d2d0):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x244b0a,_0x62d2d0);_0x585000&&(_0x348616['type']=constants['TYPE_LOSSY'],_0x4cb178=![]);break;case'VP8L':!_0x348616['vp8l']?_0x348616['vp8l']=yield _classPrivateMethodGet(this,_readChunk_VP8L,_readChunk_VP8L2)['call'](this,_0x244b0a,_0x62d2d0):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x244b0a,_0x62d2d0);_0x585000&&(_0x348616['type']=constants['TYPE_LOSSLESS'],_0x4cb178=![]);break;case'VP8X':!_0x348616['extended']?(_0x348616['type']=constants['TYPE_EXTENDED'],_0x348616['extended']=yield _classPrivateMethodGet(this,_readChunk_VP8X,_readChunk_VP8X2)['call'](this,_0x244b0a,_0x62d2d0)):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x244b0a,_0x62d2d0);break;case'ANIM':if(!_0x348616['anim']){const {raw:_0x1c7c35,bgColor:_0x185131,loopCount:_0x3cfc42}=yield _classPrivateMethodGet(this,_readChunk_ANIM,_readChunk_ANIM2)['call'](this,_0x244b0a,_0x62d2d0);_0x348616['anim']={'backgroundColor':[_0x185131[0x2],_0x185131[0x1],_0x185131[0x0],_0x185131[0x3]],'loopCount':_0x3cfc42,'frames':[]},_0x348616['anim']['raw']=_0x1c7c35;}else yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x244b0a,_0x62d2d0);break;case'ANMF':{const _0x74ed43=yield _classPrivateMethodGet(this,_readChunk_ANMF,_readChunk_ANMF2)['call'](this,_0x244b0a,_0x62d2d0);_0x348616['anim']['frames']['push'](_0x74ed43);}break;case'ALPH':!_0x348616['alph']?_0x348616['alph']=yield _classPrivateMethodGet(this,_readChunk_ALPH,_readChunk_ALPH2)['call'](this,_0x244b0a,_0x62d2d0):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x244b0a,_0x62d2d0);break;case'ICCP':!_0x348616['iccp']?_0x348616['iccp']=yield _classPrivateMethodGet(this,_readChunk_ICCP,_readChunk_ICCP2)['call'](this,_0x244b0a,_0x62d2d0):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x244b0a,_0x62d2d0);break;case'EXIF':!_0x348616['exif']?_0x348616['exif']=yield _classPrivateMethodGet(this,_readChunk_EXIF,_readChunk_EXIF2)['call'](this,_0x244b0a,_0x62d2d0):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x244b0a,_0x62d2d0);break;case'XMP\x20':!_0x348616['xmp']?_0x348616['xmp']=yield _classPrivateMethodGet(this,_readChunk_XMP,_readChunk_XMP2)['call'](this,_0x244b0a,_0x62d2d0):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x244b0a,_0x62d2d0);break;case'\x00\x00\x00\x00':_0x4cb178=![];break;default:yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x244b0a,_0x62d2d0);break;}_0x585000=![];}return _0x348616['type']==constants['TYPE_EXTENDED']&&_0x348616['extended']['hasAnim']&&(_0x348616['anim']['frameCount']=_0x348616['anim']['frames']['length']),_0x348616;});function _0x2acb1f(_0x43aeca){return _0x22140e['apply'](this,arguments);}return _0x2acb1f;}());const _default={'TYPE_LOSSY':constants['TYPE_LOSSY'],'TYPE_LOSSLESS':constants['TYPE_LOSSLESS'],'TYPE_EXTENDED':constants['TYPE_EXTENDED'],'Image':Image};exports['default']=_default;